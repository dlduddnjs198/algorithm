import java.util.*;

/**
 * ğŸ—ï¸ í™ ì •ë ¬ (Heap Sort)
 *
 * âœ… ê°œìš”
 * - ì™„ì „ ì´ì§„ íŠ¸ë¦¬ ê¸°ë°˜ì˜ **ìµœëŒ€ í™(Max Heap)**ì„ ì´ìš©í•œ ì •ë ¬ ì•Œê³ ë¦¬ì¦˜
 * - í™ì˜ íŠ¹ì„±ì„ í™œìš©í•´ ê°€ì¥ í° ê°’ì„ ë£¨íŠ¸ì— ìœ„ì¹˜ì‹œí‚¤ê³  ì •ë ¬
 *
 * âœ… í•µì‹¬ ë¡œì§
 * 1. ì£¼ì–´ì§„ ë°°ì—´ì„ **ìµœëŒ€ í™(Max Heap)**ìœ¼ë¡œ ë§Œë“ ë‹¤
 * 2. í™ì˜ ë£¨íŠ¸(ìµœëŒ€ê°’)ë¥¼ ë°°ì—´ ëìœ¼ë¡œ ë³´ë‚´ê³  í™ í¬ê¸°ë¥¼ ì¤„ì¸ë‹¤
 * 3. í™ ì†ì„±ì„ ìœ ì§€í•˜ë„ë¡ **heapify**(ì¬ì •ë ¬) í•œë‹¤
 * 4. ìœ„ ê³¼ì •ì„ ë°˜ë³µí•´ ì •ë ¬ ì™„ë£Œ
 *
 * âœ… ì‹œê°„ ë³µì¡ë„
 * - ìµœì•…/ìµœì„ /í‰ê· : O(N log N)
 *
 * âœ… ê³µê°„ ë³µì¡ë„
 * - O(1) (ì œìë¦¬ ì •ë ¬ - in-place)
 *
 * âœ… ì¥ì 
 * - ìµœì•…ì˜ ê²½ìš°ì—ë„ O(N log N)
 * - ì¬ê·€ ì‚¬ìš© ì—†ì´ êµ¬í˜„ ê°€ëŠ¥ (ë¹„ì¬ê·€ì  í™ êµ¬ì„±)
 *
 * âœ… ë‹¨ì 
 * - í€µ ì •ë ¬ë³´ë‹¤ ì¼ë°˜ì ìœ¼ë¡œ ëŠë¦¬ë‹¤ (ìºì‹œ ì¹œí™”ì„± ë‚®ìŒ)
 * - ì•ˆì • ì •ë ¬ì´ ì•„ë‹ˆë‹¤ (ê°™ì€ ê°’ì˜ ìƒëŒ€ ìˆœì„œê°€ ë°”ë€” ìˆ˜ ìˆìŒ)
 */

public class Main {

    public static void main(String[] args) {
        int[] arr = {8, 4, 1, 6, 3, 9, 2, 5, 7};

        heapSort(arr);

        System.out.println(Arrays.toString(arr));
    }

    // í™ ì •ë ¬ í•¨ìˆ˜
    private static void heapSort(int[] arr) {
        int n = arr.length;

        // 1. ìµœëŒ€ í™ ë§Œë“¤ê¸° (Bottom-up ë°©ì‹) -> ë£¨íŠ¸ê°€ í•­ìƒ ê°€ì¥ í° ê°’ì´ ë¨
        // ë¶€ëª¨ iì˜ ìì‹ ì¸ë±ìŠ¤(0-based index ê¸°ì¤€):
        // - ì™¼ìª½ ìì‹: 2 * i + 1
        // - ì˜¤ë¥¸ìª½ ìì‹: 2 * i + 2
        // ë¦¬í”„ ë…¸ë“œëŠ” ìì‹ì´ ì—†ìœ¼ë‹ˆ heapifyí•  í•„ìš” ì—†ë‹¤.
        // i >= n/2 ì¸ ì¸ë±ìŠ¤ë“¤ì€ ë¦¬í”„ ë…¸ë“œê°€ ëœë‹¤.
        // ë”°ë¼ì„œ heapify ì‹œì‘ ì§€ì ì€ n/2 - 1ë¶€í„°ë‹¤.(ì´ê²Œ ê°€ì¥ ë§ˆì§€ë§‰ ë¶€ëª¨ ë…¸ë“œì´ê¸° ë•Œë¬¸)
        for (int i = n / 2 - 1; i >= 0; i--) {
            heapify(arr, n, i);
        }

        // 2. ë£¨íŠ¸(ìµœëŒ€ê°’)ë¥¼ ëìœ¼ë¡œ ì´ë™ + í™ í¬ê¸° ì¤„ì´ë©° ì¬ì •ë ¬
        // í™ ì •ë ¬ì€ ì´ë ‡ê²Œ ë™ì‘í•¨:
        // (1). ê°€ì¥ í° ê°’ì„ ë£¨íŠ¸(0ë²ˆ)**ì— ìœ„ì¹˜ì‹œí‚´
        // (2). ê·¸ê±¸ **ë°°ì—´ ë§¨ ë’¤(n-1)**ë¡œ ë³´ëƒ„
        // (3). ë‚¨ì€ ë¶€ë¶„ë§Œ ë‹¤ì‹œ í™ êµ¬ì¡°ë¡œ ë§Œë“¦ (í¬ê¸° ì¤„ì—¬ê°€ë©°) ê·¸ëŸ¼ ì •ë ¬ì´ ëœë‹¤.
        for(int i=n-1;i>0;i--){
            swap(arr, 0, i); // ìµœëŒ€ê°’ì„ ëìœ¼ë¡œ ë³´ë‚´ê¸°
            heapify(arr, i, 0); // ì¤„ì–´ë“  í™ì— ëŒ€í•´ ë‹¤ì‹œ ìµœëŒ€ í™ êµ¬ì„±
        }

    }

    /**
     * ğŸ”¹ heapify(): í™ ì†ì„±ì„ ìœ ì§€í•˜ë„ë¡ ì¬ì •ë ¬
     * - i: í˜„ì¬ ë¶€ëª¨ ë…¸ë“œì˜ ì¸ë±ìŠ¤
     * - n: í˜„ì¬ í™ì˜ í¬ê¸°
     * - ìì‹ ë…¸ë“œì™€ ë¹„êµí•˜ì—¬ ê°€ì¥ í° ê°’ê³¼ swapí•˜ê³  ì¬ê·€ í˜¸ì¶œ
     */
    private static void heapify(int[] arr, int n, int i){
        int largest = i; // ë£¨íŠ¸
        int left = 2 * i + 1; // ì™¼ìª½ ìì‹
        int right = 2 * i + 2; // ì˜¤ë¥¸ìª½ ìì‹

        // ì™¼ìª½ ìì‹ì´ ë£¨íŠ¸ë³´ë‹¤ í¬ë©´ largest ì—…ë°ì´íŠ¸
        if(left < n && arr[left] > arr[largest]){
            largest = left;
        }

        // ì˜¤ë¥¸ìª½ ìì‹ì´ ë£¨íŠ¸ë³´ë‹¤ í¬ë©´ largest ì—…ë°ì´íŠ¸
        if(right < n && arr[right] > arr[largest]){
            largest = right;
        }

        // ê°€ì¥ í° ê°’ì´ ë£¨íŠ¸ê°€ ì•„ë‹ˆë©´ êµí™˜ + ì¬ê·€ í˜¸ì¶œ
        if(largest != i){
            swap(arr, i, largest);
            // ì „ì²´ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ê²Œ ì•„ë‹ˆë¼, íŠ¹ì • ì„œë¸ŒíŠ¸ë¦¬ ì•ˆì—ì„œ ë¬¸ì œ ìƒê¸´ ê±¸ í•´ê²°í•˜ëŠ” ë³´ì • ì‘ì—…ì´ë‹¤.
            // ë°”ë€ ìœ„ì¹˜ì— ëŒ€í•´ ë‹¤ì‹œ heapify
            heapify(arr, n, largest);
        }
    }

    // ê°’ êµí™˜ í•¨ìˆ˜
    private static void swap(int[] arr, int a, int b) {
        if (a != b) {
            int temp = arr[a];
            arr[a] = arr[b];
            arr[b] = temp;
        }
    }
}